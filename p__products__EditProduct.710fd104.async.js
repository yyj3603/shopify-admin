(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[48],{gytP:function(e,t,a){e.exports={tableList:"antd-pro-pages-products-quantity-tableList",tableListOperator:"antd-pro-pages-products-quantity-tableListOperator",tableListForm:"antd-pro-pages-products-quantity-tableListForm",submitButtons:"antd-pro-pages-products-quantity-submitButtons"}},zvP2:function(e,t,a){"use strict";a.r(t);var n,l,r,i,o=a("jehZ"),s=a.n(o),d=(a("IzEo"),a("bx4M")),c=(a("g9YV"),a("wCAj")),p=(a("14J3"),a("BMrR")),u=(a("+L6B"),a("2/Rp")),m=(a("OaEy"),a("2fM7")),h=(a("jCWc"),a("kPKH")),y=a("2Taf"),v=a.n(y),b=a("vZ4D"),f=a.n(b),g=a("l4Ni"),E=a.n(g),w=a("ujKo"),C=a.n(w),k=a("MhPg"),V=a.n(k),q=(a("2qtc"),a("kLXV")),F=(a("giR+"),a("fyUT")),_=(a("5NDa"),a("5rEg")),M=(a("y8nQ"),a("Vl3Y")),x=a("q1tI"),O=a.n(x),A=a("MuoO"),I=(a("CkN6"),a("zHco")),D=a("wY1l"),L=a.n(D),S=a("gytP"),N=a.n(S),Q=a("bcXk"),B=M["a"].Item,R=_["a"].TextArea,K=M["a"].create()(function(e){var t=e.modalVisible,a=e.form,n=e.handleAdd,l=e.handleModalVisible,r=e.selectrec,i=function(){a.validateFields(function(e,t){e||(a.resetFields(),n(r,t))})},o=0;return r.variants&&(o=1==r.variants.length?r.variants[0].price:r.variants.length>1?r.variants[0].price:0),O.a.createElement(q["a"],{destroyOnClose:!0,title:"\u7f16\u8f91\u5546\u54c1",visible:t,onOk:i,onCancel:function(){return l()}},O.a.createElement(B,{labelCol:{span:5},wrapperCol:{span:15},label:"\u5546\u54c1\u540d\u79f0"},a.getFieldDecorator("title",{rules:[{required:!0,message:"\u5546\u54c1\u540d\u4e0d\u80fd\u4e3a\u7a7a\uff01",min:1}],initialValue:r.title})(O.a.createElement(_["a"],{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0",allowClear:!0}))),O.a.createElement(B,{labelCol:{span:5},wrapperCol:{span:15},label:"\u63cf\u8ff0"},a.getFieldDecorator("body_html",{rules:[{required:!1}],initialValue:r.body_html})(O.a.createElement(R,{rows:10,placeholder:"\u8bf7\u8f93\u5165\u63cf\u8ff0",allowClear:!0}))),O.a.createElement(B,{labelCol:{span:5},wrapperCol:{span:15},label:"\u4f9b\u5e94\u5546"},a.getFieldDecorator("vendor",{rules:[{required:!0,message:"\u4f9b\u5e94\u5546\u4e0d\u80fd\u4e3a\u7a7a\uff01",min:1}],initialValue:r.vendor})(O.a.createElement(_["a"],{placeholder:"\u8bf7\u8f93\u5165\u4f9b\u5e94\u5546\u540d\u79f0",allowClear:!0}))),O.a.createElement(B,{labelCol:{span:5},wrapperCol:{span:15},label:"\u5546\u54c1\u7c7b\u578b"},a.getFieldDecorator("product_type",{rules:[{required:!1}],initialValue:r.product_type})(O.a.createElement(_["a"],{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u7c7b\u578b",allowClear:!0}))),O.a.createElement(B,{labelCol:{span:5},wrapperCol:{span:15},label:"tags"},a.getFieldDecorator("tags",{rules:[{required:!1}],initialValue:r.tags})(O.a.createElement(_["a"],{placeholder:"\u8bf7\u8f93\u5165tags(\u4f8b\uff1aBarnes & Noble, John's Fav,)",allowClear:!0}))),O.a.createElement(B,{labelCol:{span:5},wrapperCol:{span:15},label:"\u4ef7\u683c(\u5355\u4f4d:$)"},a.getFieldDecorator("price",{rules:[{required:!0,message:"\u4ef7\u683c\u4e0d\u80fd\u4e3a\u7a7a\uff01"}],initialValue:o})(O.a.createElement(F["a"],{placeholder:"\u8bf7\u8f93\u5165\u4ef7\u683c",min:"0.01",step:"0.01",allowClear:!0}))))}),j=M["a"].create()(function(e){var t=e.modalVisible,a=e.form,n=e.handleAdd,l=e.handleModalVisible,r=e.selectrec,i=function(){a.validateFields(function(e,t){e||(a.resetFields(),console.log(t.key),n(r,t))})},o=0;return r.variants&&(o=1==r.variants.length?r.variants[0].inventory_quantity:r.variants.length>1?r.variants[0].inventory_quantity:0),O.a.createElement(q["a"],{destroyOnClose:!0,title:"\u4fee\u6539\u5546\u54c1\u5e93\u5b58",visible:t,onOk:i,onCancel:function(){return l()}},O.a.createElement(B,{labelCol:{span:5},wrapperCol:{span:15},label:"\u539f\u5e93\u5b58\uff1a"},O.a.createElement("label",null,o)),O.a.createElement(B,{labelCol:{span:5},wrapperCol:{span:15},label:"\u53d8\u5316\u91cf"},O.a.createElement(F["a"],{placeholder:"\u8bf7\u8f93\u5165\u53d8\u5316\u91cf",step:"1",allowClear:!0,onBlur:function(e){a.setFieldsValue({key:Number(o)+Number(e.target.value)})}})),O.a.createElement(B,{labelCol:{span:5},wrapperCol:{span:15},label:"\u66f4\u65b0\u540e\u7684\u5e93\u5b58:"},a.getFieldDecorator("key",{rules:[{required:!1,message:"\u4ef7\u683c\u4e0d\u80fd\u4e3a\u7a7a\uff01"}],initialValue:o})(O.a.createElement(F["a"],{placeholder:"\u8bf7\u8f93\u5165\u5e93\u5b58",step:"1",min:"0",allowClear:!0}))))});function P(e){var t=[];if(e instanceof Array){for(var a=e.map(function(e){return e.vendor}),n=0;n<a.length;n++)-1==t.indexOf(a[n])&&t.push(a[n]);return t}return t}function z(e){var t=[];if(e instanceof Array){for(var a=e.map(function(e){return e.product_type}),n=0;n<a.length;n++)-1==t.indexOf(a[n])&&t.push(a[n]);return t}return t}var J=(n=Object(A["connect"])(function(e){var t=e.products,a=e.loading;e.link;return{products:t.products,link:t.link,loading:a.effects["products/fetch"]||a.effects["products/update"]}}),l=M["a"].create(),n(r=l((i=function(e){function t(){var e,a;v()(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return a=E()(this,(e=C()(t)).call.apply(e,[this].concat(l))),a.state={selectedRows:[],params:{simple:!0,current:1,pageSize:10,total:a.props.products.length},modalVisible:!1,modalVisibleQuan:!1,editingKey:"",selectrec:{},res:[],vendorlist:""},a.handleModalVisible=function(e){a.setState({modalVisible:!!e})},a.handleModalVisibleQuan=function(e){a.setState({modalVisibleQuan:!!e})},a.handleAdd=function(e,t){var n=a.props.dispatch;n({type:"products/update",payload:{productskey:e.id,parpms:{id:e.id,title:t.title,body_html:t.body_html,vendor:t.vendor,product_type:t.product_type,tags:t.tags,variants:[{id:e.variants[0].id,title:t.title,inventory_quantity:e.variants[0].inventory_quantity,price:t.price}]}}}),a.handleModalVisible()},a.handleAddQuan=function(e,t){var n=a.props.dispatch;n({type:"products/update",payload:{productskey:e.id,parpms:{id:e.id,variants:[{id:e.variants[0].id,inventory_quantity:t.key}]}}}),a.handleModalVisibleQuan()},a.handleSearch=function(e){e.preventDefault();var t=a.props,n=t.dispatch,l=t.form;l.validateFields(function(e,t){n({type:"products/search",payload:{name:t.name,type:t.type,vendor:t.vendor,namelike:t.namelike}})})},a.handleFormReset=function(){var e=a.props,t=e.form,n=e.dispatch;t.resetFields(),n({type:"products/fetch",payload:{}})},a.columns=[{title:"\u5546\u54c1\u540d\u79f0",dataIndex:"title",key:"title",width:"40%"},{title:"\u5546\u54c1\u7c7b\u578b",dataIndex:"product_type",key:"product_type",width:"8%"},{title:"\u6807\u7b7e",dataIndex:"tags",key:"tags",width:"10%"},{title:"\u5e93\u5b58",dataIndex:"variants[0].inventory_quantity",key:"inventory",width:"10%",sorter:function(e,t){return e.variants[0].inventory_quantity-t.variants[0].inventory_quantity},render:function(e,t){return t.variants[0].inventory_quantity}},{title:"\u4ef7\u683c",dataIndex:"variants[0].price",key:"price",width:"10%",sorter:function(e,t){return e.variants[0].price-t.variants[0].price},render:function(e,t){var a=0;return a="$".concat(t.variants[0].price),a}},{title:"\u4f9b\u5e94\u5546",dataIndex:"vendor",key:"vendor",width:"10%"},{title:"operation",dataIndex:"operation",width:"12%",render:function(e,t){return O.a.createElement(O.a.Fragment,null,O.a.createElement("a",{onClick:function(){return a.upquantity(t)}},"\u4fee\u6539\u5e93\u5b58"),O.a.createElement("br",null),O.a.createElement("a",{onClick:function(){return a.edit(t)}},"\u7f16\u8f91\u4ea7\u54c1"))}}],a.handlechange=function(e){var t=a.props.dispatch;t({type:"products/changepage",payload:{link:e}})},a}return V()(t,e),f()(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.dispatch;t({type:"products/fetch"}),t({type:"products/allpro",callback:function(t){e.setState({res:t.data.products})}})}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator,t=P(this.state.res).map(function(e){return O.a.createElement(Option,{value:e},e)}),a=z(this.state.res).map(function(e){return O.a.createElement(Option,{value:e},e)});return O.a.createElement(M["a"],{onSubmit:this.handleSearch,layout:"inline"},O.a.createElement(p["a"],{gutter:{md:8,lg:24,xl:48}},O.a.createElement(h["a"],{md:6,sm:8},O.a.createElement(M["a"].Item,{label:"\u5546\u54c1\u540d\u79f0"},e("name")(O.a.createElement(_["a"],{placeholder:"\u8bf7\u8f93\u5165"})))),O.a.createElement(h["a"],{md:6,sm:8},O.a.createElement(M["a"].Item,{label:"\u5546\u54c1\u7c7b\u578b"},e("type")(O.a.createElement(m["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"120px"}},a)))),O.a.createElement(h["a"],{md:6,sm:8},O.a.createElement(M["a"].Item,{label:"\u4f9b\u5e94\u5546"},e("vendor")(O.a.createElement(m["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"120px"}},t)))),O.a.createElement(h["a"],{md:4,sm:8},O.a.createElement("span",{className:N.a.submitButtons},O.a.createElement(u["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2"),O.a.createElement(u["a"],{style:{marginLeft:8},onClick:this.handleFormReset},"\u91cd\u7f6e")))))}},{key:"upquantity",value:function(e){this.handleModalVisibleQuan(!0),this.setState({selectrec:e,editingKey:e.id})}},{key:"edit",value:function(e){this.handleModalVisible(!0),this.setState({selectrec:e,editingKey:e.id})}},{key:"render",value:function(){var e=this.props.loading,t=this.props,a=t.products,n=t.link,l=this.state,r=(l.selectedRows,l.params,l.modalVisible),i=l.selectrec,o=l.modalVisibleQuan,p={handleAdd:this.handleAdd,handleModalVisible:this.handleModalVisible},m={handleAdd:this.handleAddQuan,handleModalVisible:this.handleModalVisibleQuan};return console.log(i),O.a.createElement(I["a"],{title:"\u5546\u54c1\u5217\u8868"},O.a.createElement(d["a"],null,O.a.createElement("div",{className:N.a.tableList},O.a.createElement("div",null,this.renderSimpleForm()),O.a.createElement("div",{className:N.a.tableListOperator},O.a.createElement(L.a,{to:"/products/addproduct"},O.a.createElement(u["a"],{icon:"plus",type:"primary"},"\u65b0\u5efa"))),O.a.createElement(c["a"],{bordered:!0,dataSource:a,columns:this.columns,rowClassName:"editable-row",pagination:!1,loading:e,rowKey:"id"})),O.a.createElement(Q["a"],{handlechange:this.handlechange,Link:n})),O.a.createElement(K,s()({},p,{modalVisible:r,selectrec:i})),O.a.createElement(j,s()({},m,{modalVisible:o,selectrec:i})))}}]),t}(x["Component"]),r=i))||r)||r);t["default"]=J}}]);